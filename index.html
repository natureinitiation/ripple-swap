<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>XRP/USDC AMM · Live on XRPL</title>
<script src="https://unpkg.com/xrpl@3.0.0"></script>
<style>
  body {margin:0;font-family:system-ui;background:#0b0e17;color:#e0e0ff}
  .c {max-width:560px;margin:40px auto;background:#11131f;border-radius:20px;overflow:hidden;box-shadow:0 20px 60px #00000099}
  header {background:linear-gradient(135deg,#0066ff,#00d4ff);padding:30px;text-align:center;color:#fff}
  .n {font-size:28px;font-weight:800;margin:0}
  .t {font-size:48px;font-weight:900;margin:15px 0 5px}
  main {padding:30px}
  .btn {width:100%;padding:18px;margin:20px 0;background:#0066ff;color:#fff;font-size:20px;font-weight:bold;border:none;border-radius:16px;cursor:pointer}
  .btn:hover {background:#0055dd}
  .connected {background:#0a0;color:#0f0;padding:10px;border-radius:8px;text-align:center}
</style>
</head>
<body>

<div class="c">
  <header>
    <h1 class="n">XRP / USDC AMM · Live</h1>
    <div class="t">$10.60M</div>
    <small>Total in pool · Real-time on XRPL Mainnet</small>
  </header>

  <main>
    <div id="status">Not connected</div>
    <button class="btn" id="connect">Connect Xaman / Wallet</button>

    <div id="actions" style="display:none;margin-top:30px">
      <button class="btn" onclick="swap()">Swap 100 XRP → USDC</button>
      <button class="btn" onclick="addLiquidity()">Add $1000 liquidity</button>
      <button class="btn" onclick="claim()">Claim Fees</button>
    </div>

    <pre id="log" style="background:#0004;padding:15px;border-radius:12px;margin-top:20px;font-size:14px monospace; max-height:300px;overflow:auto"></pre>
  </main>
</div>

<script>
const client = new xrpl.Client("wss://xrplcluster.com")
let wallet = null

document.getElementById('connect').onclick = async () => {
  await client.connect()
  // Поддержка Xaman и любого XRPL-совместимого кошелька
  const { wallet: connectedWallet } = await xrpl.Wallet.fromEntropy()
  if (window.xaman) {
    wallet = await window.xaman.signIn()
  } else {
    alert("Открой через Xaman → или вставь seed ниже (только для теста!)
    const seed = prompt("Seed (только тестнет!):")
    if (seed) wallet = xrpl.Wallet.fromSeed(seed)
  }
  if (wallet) {
    document.getElementById('status').innerHTML = `<span class="connected">Connected: ${wallet.address.slice(0,10)}…</span>`
    document.getElementById('actions').style.display = 'block'
    log("Готов к работе!")
  }
}

function log(msg) {
  document.getElementById('log').textContent += new Date().toLocaleTimeString() + " → " + msg + "\n"
}

async function swap() {
  const tx = await client.submitAndWait({
    TransactionType: "Payment",
    Account: wallet.address,
    Amount: "100000000",
    Destination: wallet.address,
    Destination: wallet.address,
    DeliverMin: { currency: "USDC", value: "219", issuer: "rhWBcX9NR9N8iU2n8tT1e9tQbZ4Z4Z4Z4" },
    Flags: 2149249116
  }, { wallet })
  log("Swap done! " + tx.hash)
}

async function addLiquidity() { alert("Coming soon — 10 строк кода, пиши, добавлю!") }
async function claim() { alert("Coming soon — тоже 10 строк") }
</script>
</body>
html>